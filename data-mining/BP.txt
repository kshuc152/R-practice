Input1	Input2	Input3	Output80	3	50	1190	8	70	12.5180	20	120	20140	16	90	18120	5	85	15.5Code:
>library(grid)   #加载相应的程序包>library(MASS)>library(neuralnet)> p <- matrix(c(80.0,90.0,180.0,140.0,120.0,3.0,8.0,20.0,16.0,5.0,50.0,70.0,120.0,90.0,85.0),5,3,byrow = T)> t <- c(11.0,12.5,20.0,18.0,15.5)> trainingdata <- cbind(p,t) #合并数据集> trainingdata                    t[1,]  80  90 180 11.0[2,] 140 120   3 12.5[3,]   8  20  16 20.0[4,]   5  50  70 18.0[5,] 120  90  85 15.5> colnames(trainingdata) <- c("Input1","Input2","Input3","Output")> net <- neuralnet(Output~Input1+Input2+Input3,trainingdata, hidden=20, threshold=0.001)   #建立神经网络，三个输入，一个输出，，隐含层20个，阈值为0.001> print(net)   #输出网络$callneuralnet(formula = Output ~ Input1 + Input2 + Input3, data = trainingdata,     hidden = 20, threshold = 0.001)$response  Output1   11.02   12.53   20.04   18.05   15.5$covariate     [,1] [,2] [,3][1,]   80   90  180[2,]  140  120    3[3,]    8   20   16[4,]    5   50   70[5,]  120   90   85$model.list$model.list$response[1] "Output"$model.list$variables[1] "Input1" "Input2" "Input3"$err.fctfunction (x, y) {    1/2 * (y - x)^2}<environment: 0x0000000004eea0d8>attr(,"type")[1] "sse"$act.fctfunction (x) {    1/(1 + exp(-x))}<environment: 0x0000000004eea0d8>attr(,"type")[1] "logistic"$linear.output[1] TRUE$data  Input1 Input2 Input3 Output1     80     90    180   11.02    140    120      3   12.53      8     20     16   20.04      5     50     70   18.05    120     90     85   15.5$net.result$net.result[[1]]         [,1]1 11.000222622 12.500029563 19.999903494 17.999942065 15.50000734$weights$weights[[1]]$weights[[1]][[1]]              [,1]          [,2]           [,3]          [,4]           [,5]         [,6]         [,7]          [,8][1,] -1.1106326592 -0.3692142515  3.09377134500  0.7023913635 -1.10113797231 0.6315100233 1.2767153645 -3.9325307786[2,]  0.0571874855  0.5759398817  1.00960949939  0.4460790641  0.60425277870 1.3755368996 0.9233213585 -1.4644992906[3,]  1.0044601432  1.7883150552 -1.30057662011  2.8804629847 -0.84315121596 0.1767784429 0.7196932289 -0.6606546743[4,]  1.1056690417  0.5288752645 -0.09362196728 -1.8240458105  0.01763404425 1.3679264901 1.0233288345  0.3034613217              [,9]         [,10]          [,11]         [,12]          [,13]         [,14]           [,15]         [,16][1,]  1.3872130337  0.6386700908  2.71330091447  1.6336113910  0.84365557896 -0.2204781004  6.487034345662  0.2213707103[2,] -1.0267260102 -0.7377234877 -0.16402484332 -0.4659756299 -0.09066369962  1.0490079176 -0.882288498042  2.2540644584[3,] -1.6760089176  1.2614415665  0.05235087909  1.1192826550  1.57965682504  0.8056289787  0.552012549609  1.2853184441[4,]  0.8858924566  1.4256575102  3.31332655082 -0.8343937497  0.37191217521  0.8021910567  0.004707830852 -0.2154763965             [,17]          [,18]         [,19]          [,20][1,] -1.1826216181  0.49734470051  2.1548005230  0.32522259695[2,] -0.6525197586 -0.27678345458 -1.1830627470  2.15334606642[3,] -0.9372158548 -0.05383881237  0.8529713592  1.12879702112[4,]  0.5625470704  2.53616975955  1.6867726709 -0.06637341089$weights[[1]][[2]]               [,1] [1,] -0.9252220657 [2,] -0.5546037838 [3,]  0.5064494076 [4,]  3.0467278427 [5,]  3.4418266262 [6,]  1.8337851519 [7,]  0.1294662876 [8,]  2.0927533349 [9,]  1.4398949546[10,]  1.6617881888[11,]  1.0329417718[12,]  2.1692610774[13,]  2.0887511046[14,]  1.8576300390[15,]  2.3566459081[16,]  3.4712120818[17,]  0.9793579165[18,]  0.5620786543[19,]  0.8348770605[20,]  1.0646035989[21,] -0.5439423794$startweights$startweights[[1]]$startweights[[1]][[1]]              [,1]          [,2]          [,3]            [,4]          [,5]          [,6]         [,7]          [,8][1,] -1.1106326592 -0.3692142515  1.0356285809 -0.003290362235 -1.4555320156 -0.8368899767 0.7767153645 -3.8525601615[2,]  0.0571874855  0.5759398817 -0.3636678867 -0.040310525764  1.3382343632 -0.0928631004 0.4233213585 -1.4196910265[3,]  1.0044601432  1.7883150552 -2.7830154920  2.174781259037 -0.2294885275 -1.2916215571 0.2196932289 -0.5772060789[4,]  1.1056690417  0.5288752645 -1.5760608392 -2.457540036182 -0.3367599990 -0.1004735099 0.5233288345  0.3920434879              [,9]          [,10]         [,11]         [,12]          [,13]         [,14]         [,15]         [,16][1,]  1.0170213903  0.03867009078  0.5220917227  1.1821686242  0.04365557896 -1.6204781004  1.3187250649 -0.7786292897[2,] -1.4378825455 -1.33772348766 -1.2281363809 -0.9180734305 -0.89066369962 -0.3509920824 -1.1315125578  1.2540644584[3,] -2.0380321264  0.66144156654 -1.0134330149  0.6717826617  0.77965682504 -0.5943710213  0.2664212056  0.2853184441[4,]  0.5338494432  0.82565751024 -0.3430940433 -1.2906801167 -0.42808782479 -0.5978089433  0.1354888812 -1.2154763965              [,17]         [,18]         [,19]         [,20][1,] -0.20922160464 -0.4752765037  1.6589186767 -1.4431774030[2,]  0.31168464016 -0.4935168379 -1.6789445933  0.3849460664[3,]  0.03618415859 -0.5708469990  0.3570895129 -0.6396029789[4,]  1.51837433643  0.1783629025  1.1908908246 -1.8347734109$startweights[[1]][[2]]                [,1] [1,] -1.55297805571 [2,] -1.18235977380 [3,] -0.12130658240 [4,]  0.98858507864 [5,]  1.26018903759 [6,] -1.25220889137 [7,] -0.09850233803 [8,]  1.46499734489 [9,] -1.21173442827[10,] -1.04000345471[11,]  0.40518578174[12,]  1.37011722568[13,] -0.53700207754[14,]  1.22987404892[15,]  1.72888991804[16,] -1.01779580974[17,]  0.35160192649[18,] -1.06452133228[19,] -0.04267898375[20,]  0.18704755468[21,] -0.01409328108$generalized.weights$generalized.weights[[1]]                  [,1]                 [,2]                   [,3]1  0.00000003567674698 -0.00000002232144395 -0.00000000019037133062  0.00004240629056163 -0.00001339512620290 -0.00085950666757715953  0.00000267650357156 -0.00000605997340493  0.00000442584694810314  0.00012652914067271 -0.00030389529388698  0.00022654703332133675 -0.00319608823104961  0.00414159636263187  0.0002686143334373428$result.matrix                                           1error                    0.00000003157956559reached.threshold        0.00058241170144927steps                  162.00000000000000000Intercept.to.1layhid1   -1.11063265915212850Input1.to.1layhid1       0.05718748549879120Input2.to.1layhid1       1.00446014319478083Input3.to.1layhid1       1.10566904171514624Intercept.to.1layhid2   -0.36921425153151749Input1.to.1layhid2       0.57593988170223376Input2.to.1layhid2       1.78831505521559042Input3.to.1layhid2       0.52887526449359790Intercept.to.1layhid3    3.09377134499654138Input1.to.1layhid3       1.00960949939090217Input2.to.1layhid3      -1.30057662011100006Input3.to.1layhid3      -0.09362196727859613Intercept.to.1layhid4    0.70239136345100350Input1.to.1layhid4       0.44607906406545678Input2.to.1layhid4       2.88046298472310580Input3.to.1layhid4      -1.82404581049556347Intercept.to.1layhid5   -1.10113797230585519Input1.to.1layhid5       0.60425277869531480Input2.to.1layhid5      -0.84315121596173115Input3.to.1layhid5       0.01763404425036873Intercept.to.1layhid6    0.63151002328828765Input1.to.1layhid6       1.37553689959829861Input2.to.1layhid6       0.17677844291377656Input3.to.1layhid6       1.36792649014624823Intercept.to.1layhid7    1.27671536448975664Input1.to.1layhid7       0.92332135854401942Input2.to.1layhid7       0.71969322894858268Input3.to.1layhid7       1.02332883452760526Intercept.to.1layhid8   -3.93253077857537159Input1.to.1layhid8      -1.46449929060984019Input2.to.1layhid8      -0.66065467428608460Input3.to.1layhid8       0.30346132168076712Intercept.to.1layhid9    1.38721303372729432Input1.to.1layhid9      -1.02672601015368792Input2.to.1layhid9      -1.67600891756188530Input3.to.1layhid9       0.88589245659210392Intercept.to.1layhid10   0.63867009078478643Input1.to.1layhid10     -0.73772348766428120Input2.to.1layhid10      1.26144156653650863Input3.to.1layhid10      1.42565751023578469Intercept.to.1layhid11   2.71330091446773691Input1.to.1layhid11     -0.16402484331769554Input2.to.1layhid11      0.05235087909165716Input3.to.1layhid11      3.31332655082261773Intercept.to.1layhid12   1.63361139101094310Input1.to.1layhid12     -0.46597562990174901Input2.to.1layhid12      1.11928265501082391Input3.to.1layhid12     -0.83439374971261804Intercept.to.1layhid13   0.84365557896258081Input1.to.1layhid13     -0.09066369961968274Input2.to.1layhid13      1.57965682503895333Input3.to.1layhid13      0.37191217520677344Intercept.to.1layhid14  -0.22047810041129565Input1.to.1layhid14      1.04900791757976308Input2.to.1layhid14      0.80562897865371230Input3.to.1layhid14      0.80219105665192980Intercept.to.1layhid15   6.48703434566221038Input1.to.1layhid15     -0.88228849804219034Input2.to.1layhid15      0.55201254960921420Input3.to.1layhid15      0.00470783085196368Intercept.to.1layhid16   0.22137071026575042Input1.to.1layhid16      2.25406445837459746Input2.to.1layhid16      1.28531844405461038Input3.to.1layhid16     -0.21547639652000014Intercept.to.1layhid17  -1.18262161807320521Input1.to.1layhid17     -0.65251975860311018Input2.to.1layhid17     -0.93721585484689418Input3.to.1layhid17      0.56254707036404317Intercept.to.1layhid18   0.49734470050994312Input1.to.1layhid18     -0.27678345457746167Input2.to.1layhid18     -0.05383881237222982Input3.to.1layhid18      2.53616975954732560Intercept.to.1layhid19   2.15480052296710189Input1.to.1layhid19     -1.18306274703842873Input2.to.1layhid19      0.85297135918217770Input3.to.1layhid19      1.68677267085937599Intercept.to.1layhid20   0.32522259695463090Input1.to.1layhid20      2.15334606642405424Input2.to.1layhid20      1.12879702112174085Input3.to.1layhid20     -0.06637341088559373Intercept.to.Output     -0.925222065675848971layhid.1.to.Output     -0.554603783761044581layhid.2.to.Output      0.506449407641608731layhid.3.to.Output      3.046727842689822111layhid.4.to.Output      3.441826626160620521layhid.5.to.Output      1.833785151881289771layhid.6.to.Output      0.129466287623308421layhid.7.to.Output      2.092753334930788971layhid.8.to.Output      1.439894954637320091layhid.9.to.Output      1.661788188768241301layhid.10.to.Output     1.032941771777760481layhid.11.to.Output     2.169261077359781351layhid.12.to.Output     2.088751104609954721layhid.13.to.Output     1.857630038952268191layhid.14.to.Output     2.356645908080542641layhid.15.to.Output     3.471212081771652521layhid.16.to.Output     0.979357916530468221layhid.17.to.Output     0.562078654286831351layhid.18.to.Output     0.834877060503630751layhid.19.to.Output     1.064603598937239331layhid.20.to.Output    -0.54394237935682677attr(,"class")[1] "nn"> plot(net)   #绘制神经网络拓扑图> testdata <- trainingdata[,1:3]   #建立测试数据集> net.results <- compute(net, testdata)   #测试数据> ls(net.results)   #查看特定环境的对象名称[1] "net.result" "neurons"   > print(net.results$net.result) #输出神经网络预测结果            [,1][1,] 11.00022262[2,] 12.50002956[3,] 19.99990349[4,] 17.99994206[5,] 15.50000734> cleanoutput <- cbind(testdata,trainingdata[,4],as.data.frame(net.results$net.result))   #合并数据> colnames(cleanoutput) <- c("Input1","Input2","Input3","Expected Output","Neural Net Output")   #设置列名> print(cleanoutput)   #输出数据  Input1 Input2 Input3 Expected Output Neural Net Output1     80     90    180            11.0       11.000222622    140    120      3            12.5       12.500029563      8     20     16            20.0       19.999903494      5     50     70            18.0       17.999942065    120     90     85            15.5       15.50000734